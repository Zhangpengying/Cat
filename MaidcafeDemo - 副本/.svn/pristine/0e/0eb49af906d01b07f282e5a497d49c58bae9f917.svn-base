using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Chair : MonoBase
{
    //玩家是否在椅子位置
    public bool canSit = false;
    //椅子的ID
    public int chairID;
    
	// Use this for initialization
	void Start () {
        EventManager.instance.RegisterReceiver(this);
        //注册事件
        StaticVar.AddEvents(gameObject);
    }

    // Update is called once per frame
    void Update () {
        if (canSit)
        {
            //玩家坐下
            Player player = GameObject.Find("Characters/大壮").GetComponent<Player>();
            if (Input.GetKeyDown(KeyCode.DownArrow) )
            {
                if (gameObject == StaticVar.InteractiveProp)
                {
                    player._transform.position = transform.Find("SitPoint").position;
                    player.GetComponent<SpriteRenderer>().flipX = !transform.GetComponent<SpriteRenderer>().flipX;
                    player._ani.SetBool("IsSit", true);
                }
            }
        }
	}

    public override void ReciveMessage(Message msg)
    {
        base.ReciveMessage(msg);

        if (msg.Command == MyMessageType.Event_EnterChair)
        {
            canSit = true;
        }
        else if (msg.Command == MyMessageType.Event_LeaveChair)
        {
            canSit = false;
            StaticVar.InteractiveProp = null;
        }
      
    }
}
